!function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractModule=void 0;var o=function(t,e){void 0===e&&(e=null),this.cashtippr=t,this.webHelpers=e||this.cashtippr.getWebHelpers()};e.AbstractModule=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CashTippr=void 0;var o=i(3),n=i(4),r=i(5),s=i(6),a=i(7),c=i(8),p=i(9),l=i(12),d=i(14),h=i(15),u=function(){function t(t,e){var i=this;this.window=t,this.$=e,this.config=this.window.cashtipprCfg||{},this.addDefaultConfig(this.config),this.webHelpers=new n.WebHelpers(this.window,this.$,this.config),this.tooltips=new o.Tooltips(this,this.webHelpers),this.adminControls=new h.AdminControls(this),this.badger=new c.BadgerWallet(this,this.webHelpers,!0),this.qr=new a.QrCode(this,this.webHelpers),this.adBlockDetect=new d.AdBlockDetect(this,this.webHelpers),this.blurryImage=new r.BlurryImage(this,this.webHelpers),this.shout=new s.Shout(this,this.webHelpers),this.woocommerce=new l.Woocommerce(this,this.webHelpers),this.slpPress=new p.SlpPress(this),this.$(this.window.document).ready((function(t){i.adminConfig=i.window.cashtipprAdminCfg||{},i.window.cashtipprAdminCfg&&(i.addDefaultConfig(i.adminConfig),i.webHelpers.setConfig(i.adminConfig)),i.adminControls.init(),i.webHelpers.checkCookieConsent()}))}return t.toSatoshis=function(t){return Math.floor(1e8*t)},t.prototype.getConfig=function(){return this.config},t.prototype.getAdminConfig=function(){return this.adminConfig},t.prototype.getTooltips=function(){return this.tooltips},t.prototype.getWebHelpers=function(){return this.webHelpers},t.prototype.getBadgerWallet=function(){return this.badger},t.prototype.getPluginPaymentID=function(t){return t.attr("id").replace(/^ct-btn-wrap-/,"")},t.prototype.addCopyInputListeners=function(){var t=this;this.$(".ct-copy-field").click((function(e){e.preventDefault();var i=t.$(e.target).parent().find("input[type='text']");i.select();try{t.window.document.execCommand("copy")}catch(t){}i.select()})),this.$("#ct-qrcode-form input[type='text']").click((function(e){t.$(e.target).select()})),!0===this.webHelpers.isAppleIOS()&&this.$("#ct-qrcode-form .ct-copy-field").addClass("hidden")},t.prototype.addDefaultConfig=function(e){e.consentCookieName=t.CONSENT_COOKIE_NAME,e.confirmCookiesMsg=t.CONFIRM_COOKIES_MSG,e.confirmCookiesBtn=t.CONFIRM_COOKIES_BTN},t.CONSENT_COOKIE_NAME="ct-ck",t.CONFIRM_COOKIES_MSG="#ct-cookieMsg",t.CONFIRM_COOKIES_BTN="#ct-confirmCookies",t}();e.CashTippr=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=new(i(1).CashTippr)(window,jQuery);window.cashtippr=o},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Tooltips=void 0;var r=function(t){function e(e,i){return t.call(this,e,i)||this}return n(e,t),e.prototype.initToolTips=function(){var t,e=this.cashtippr.window,i=this.cashtippr.$,o=this,n={debug:!1},r=0,s=!1,a=function(t,e){void 0===e&&(e=!1),e=e||!1;var o="pointerdown.tsfTT touchstart.tsfTT click.tsfTT",n=i(t);e?(n.off("mousemove mouseleave mouseout ct-tooltip-update"),i(document.body).off(o)):(n.on({mousemove:p,mouseleave:l,mouseout:l}),i(document.body).off(o).on(o,d)),n.on("ct-tooltip-update",c)},c=function(t){if(t.target.classList.contains("ct-tooltip-item")){var e=t.target.querySelector(".ct-tooltip-text");e instanceof Element&&(e.innerHTML=t.target.dataset.desc)}},p=function(t){var e=i(t.target),o=e.find(".ct-tooltip"),n=o.find(".ct-tooltip-arrow"),r=o.data("overflow"),s=o.data("overflowDir");if(r=parseInt(r,10),r=isNaN(r)?0:-Math.round(r))n.css(s,r+"px");else{var a=t.originalEvent&&t.originalEvent.pageX||t.pageX,c=e.closest(".ct-tooltip-wrap"),p=a-c.offset().left-8,l=o.find(".ct-tooltip-text-wrap"),d=l.outerWidth(!0),h=o.data("adjust"),u=o.data("adjustDir"),f=d-16-7;if(h=parseInt(h,10),h=isNaN(h)?0:Math.round(h))if(p+=h="left"===u?-h:h,f-h>c.outerWidth(!0))f=l.find(".ct-tooltip-text").outerWidth(!0)-16-7;p<=7?n.css("left","7px"):p>=f?n.css("left",f+"px"):n.css("left",p+"px")}},l=function(t){var e;s||(i(t.target).find(".ct-tooltip").remove(),e=t.target,a(e,!0))},d=function(t){s=!0,clearTimeout(r),r=setTimeout((function(){s=!1}),250);var e,o=i(t.target);if(o.hasClass("ct-tooltip-item")&&(e=o.find(".ct-tooltip")),!e){var n=o.children(".ct-tooltip-item");n.length&&(e=n.find(".ct-tooltip"))}e&&e.length?i(".ct-tooltip").not(e).remove():i(".ct-tooltip").remove()},h=function(t){if(!s){var e=!1;switch(t.type){case"mouseenter":break;case"pointerdown":case"touchstart":e=!0}if(t.target.classList.contains("ct-tooltip-item"))e&&d(t),function(t){var e=i(t.target),o=t.target.dataset.desc;if(o&&0===e.find("div").length){t.target.title="";var n=i('<div class="ct-tooltip"><span class="ct-tooltip-text-wrap"><span class="ct-tooltip-text">'+o+'</span></span><div class="ct-tooltip-arrow"></div></div>');e.append(n);var r=e.closest(".ct-tooltip-boundary");r=r.length&&r||i(document.body);var s=e.outerHeight()+9,a=n.offset().top-s;r.offset().top-(r.prop("scrolltop")||0)>a?(n.addClass("ct-tooltip-down"),n.css("top",s+"px")):n.css("bottom",s+"px");var c=e.closest(".ct-tooltip-wrap"),p=n.find(".ct-tooltip-text-wrap"),l=p.find(".ct-tooltip-text"),d=c.width(),h=p.outerWidth(!0),u=l.outerWidth(!0),f=p.offset().left,g=f+u,w=r.offset().left-(r.prop("scrollLeft")||0),b=w+r.outerWidth();if(f<w)(m=w-f+12)<-(v=parseInt(p.css("flex-basis"),10))&&(m=-v),n.css("left",m+"px"),n.data("overflow",m),n.data("overflowDir","left");else if(g>b){var m,v;(m=b-g-d-12)<-(v=parseInt(p.css("flex-basis"),10))&&(m=-v),n.css("left",m+"px"),n.data("overflow",m),n.data("overflowDir","left")}else if(d<42){n.css("left","-15px"),n.data("overflow",-15),n.data("overflowDir","left")}else if(d>h){var y=(t.originalEvent&&t.originalEvent.pageX||t.pageX)-c.offset().left-h/2,_=y+h;y<0?y=0:_>d&&(y=d-u),n.css("left",y+"px"),n.data("adjust",y),n.data("adjustDir","left")}}}(t),p(t),a(t.target);else{var o=t.target.querySelector(".ct-tooltip-item:hover"),r=new i.Event(t.type);r.pageX=t.originalEvent&&t.originalEvent.pageX||t.pageX,o?(n.debug&&console.log("Tooltip event warning: delegation"),i(o).trigger(r)):(n.debug&&console.log("Tooltip event warning: bubbling"),i(t.target).closest(".ct-tooltip-wrap").find(".ct-tooltip-item:hover").trigger(r))}t.stopPropagation()}},u=function(){var t=i(".ct-tooltip-wrap");t.off("mouseenter pointerdown touchstart"),t.on("mouseenter pointerdown touchstart",".ct-tooltip-item",h)};u(),i(e).on("ct-reset-tooltips",u),t=i("#wpcontent"),o.addTooltipBoundary(t)},e.prototype.addTooltipBoundary=function(t){jQuery(t).addClass("ct-tooltip-boundary")},e.prototype._triggerTooltipReset=function(){jQuery(window).trigger("ct-reset-tooltips")},e.prototype._triggerTooltipUpdate=function(t){jQuery(t).trigger("ct-tooltip-update")},e}(i(0).AbstractModule);e.Tooltips=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebHelpers=void 0;var o=function(){function t(t,e,i){this.cssSelectors=[],this.window=t,this.$=e,this.config=i}return t.prototype.setConfig=function(t){this.config=t},t.prototype.getBrowserLang=function(){return this.window.navigator.language.substr(0,2).toLowerCase()},t.prototype.getCookie=function(t){var e,i,o,n=this.window.document.cookie.split(";");for(e=0;e<n.length;e++)if(i=n[e].substr(0,n[e].indexOf("=")),o=n[e].substr(n[e].indexOf("=")+1),(i=i.replace(/^\s+|\s+$/g,""))==t)return decodeURI(o);return null},t.prototype.setCookie=function(t,e,i){var o=new Date;o=new Date(o.getTime()+864e5*(i||this.config.cookieLifeDays)),this.window.document.cookie=t+"="+e+"; expires="+o.toUTCString()+"; path="+this.config.cookiePath},t.prototype.removeCookie=function(t){this.window.document.cookie=t+"=; expires=Thu, 02 Jan 1970 00:00:00 UTC; path="+this.config.cookiePath},t.prototype.checkCookieConsent=function(){var t=this;this.$(this.config.confirmCookiesBtn).click((function(){t.confirmCookies()})),null!==this.getCookie(this.config.consentCookieName)&&this.$(this.config.confirmCookiesMsg).remove()},t.prototype.fromBase64=function(t){return"function"!=typeof this.window.atob?(this.window.console.error("Base64 decoding is not supported in your browser"),""):this.window.atob(t)},t.prototype.toBase64=function(t){return"function"!=typeof this.window.btoa?(this.window.console.error("Base64 encoding is not supported in your browser"),""):this.window.btoa(t)},t.prototype.translate=function(t,e,i){if(void 0===i&&(i=!1),"string"!=typeof t)try{t=t.toString()}catch(e){return this.log("Text to translate is not a string"),t}for(var o=0,n=0;-1!==(o=t.indexOf("{",o));)if(o>0&&"\\"===t.charAt(o-1))o++;else{if(-1===(n=t.indexOf("}",o))){this.log("Can not find end position while translating HTML");break}var r=t.substring(o+1,n),s=null;if("tr:"===r.substring(0,3)){var a=r.substring(3);s=this.tr(a)}else if("object"==typeof e){var c=e[r];void 0!==c&&(s="boolean"==typeof i&&i?c:this.escapeOutput(c))}if(null!==s){var p=new RegExp("\\{"+r+"\\}","g");t=t.replace(p,s)}else if(null!==r.match("^[A-Za-z0-9_]+$")){this.log("No translation found for place holder: "+r);p=new RegExp("\\{"+r+"\\}","g");t=t.replace(p,"MISSING: "+this.escapeOutput(r))}else o+=r.length}return t=t.replace(/\\\\\\{/,"{")},t.prototype.escapeOutput=function(t,e){return void 0===e&&(e=!0),"string"!=typeof t?t:(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),void 0!==e&&!0!==e||(t=t.replace(/\r?\n/g,"<br>")),t)},t.prototype.escapeRegex=function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},t.prototype.tr=function(t){return t},t.prototype.log=function(t){"object"==typeof this.window.console&&"function"==typeof this.window.console.log&&this.window.console.log(arguments)},t.prototype.isAppleIOS=function(){return/iPad|iPhone|iPod/.test(this.window.navigator.userAgent)&&!this.window.MSStream},t.prototype.getAllCssSelectors=function(t){if(void 0===t&&(t=!0),!0===t&&0!==this.cssSelectors.length)return this.cssSelectors;this.cssSelectors=[];try{for(var e=new RegExp("^"+this.escapeRegex(this.window.document.location.origin),"i"),i=0;i<this.window.document.styleSheets.length;i++){var o=this.window.document.styleSheets[i];if(!o.href||!1!==e.test(o.href)){if(o.rules)for(var n=0;n<o.rules.length;n++)o.rules[n].selectorText&&this.cssSelectors.push(o.rules[n].selectorText);if(o.imports)for(var r=0;r<o.imports.length;r++)for(n=0;n<o.imports[r].rules.length;n++)o.imports[r].rules[n].selectorText&&this.cssSelectors.push(o.imports[r].rules[n].selectorText)}}}catch(t){this.window.console.error("Error getting CSS selectors",t)}return this.cssSelectors},t.prototype.isExistingCssSelector=function(t){for(var e=this.getAllCssSelectors(),i=0;i<e.length;i++)if(e[i]===t)return!0;return!1},t.prototype.confirmCookies=function(){this.$(this.config.confirmCookiesMsg).remove(),this.setCookie(this.config.consentCookieName,"1",this.config.cookieLifeDays)},t.prototype.getApi=function(t,e,i,o){"function"==typeof e?(i=e,e=null):void 0===e&&(e=null);var n=t;return 0!==n.toLowerCase().indexOf("http")&&(n=this.config.siteUrl+n),this.$.get(n,e,(function(t,e,o){i(t,e,o)}),o)},t.prototype.postApi=function(t,e,i,o){var n=t;return 0!==n.toLowerCase().indexOf("http")&&(n=this.config.siteUrl+n),this.$.post(n,e,(function(t,e,o){i(t,e,o)}),o)},t.prototype.postApiJson=function(t,e,i,o){var n={data:JSON.stringify(e)};return this.postApi(t,n,i,o)},t}();e.WebHelpers=o},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.BlurryImage=void 0;var r=function(t){function e(e,i){return t.call(this,e,i)||this}return n(e,t),e}(i(0).AbstractModule);e.BlurryImage=r},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Shout=void 0;var r=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.scheduleUpdateTimerID=0,o.cashtippr.$(o.cashtippr.window.document).ready((function(t){0!==o.cashtippr.$(".ct-message").length&&(o.updateRemainingChars(),o.addEventListeners())})),o.cashtippr.$(o.cashtippr.window.document).ready((function(t){o.addConfirmDeleteMessages()})),o}return n(e,t),e.prototype.onPayment=function(t){var e=this;setTimeout((function(){e.cashtippr.$("#"+t.domID).parent().parent().submit()}),500)},e.prototype.updateRemainingChars=function(){var t=this,e=this.cashtippr.$(".ct-message").parent().parent();this.cashtippr.$.each(e,(function(e,i){var o=t.cashtippr.$(i),n=o.find(".ct-message").val(),r=parseInt(o.find(".ct-max-chars").val())-n.length;o.find(".ct-chars-left").text(r),r<0?(o.find(".ct-chars-left").css("color","red"),o.find(".ct-shout").prop("disabled",!0),o.find(".ct-button").fadeOut("slow")):(o.find(".ct-chars-left").css("color",""),0===n.length?(o.find(".ct-shout").prop("disabled",!0),o.find(".ct-button").fadeOut("slow")):(o.find(".ct-shout").prop("disabled",!1),o.find(".ct-button").fadeIn("slow")))}))},e.prototype.addEventListeners=function(){var t=this;this.cashtippr.$(".ct-message").keyup((function(e){t.scheduleCharsUpdate()})),this.cashtippr.$(".ct-message").change((function(e){t.scheduleCharsUpdate()})),this.cashtippr.$(".ct-shout-form").on("submit.cashtippr",(function(e){e.preventDefault(),t.cashtippr.$(e.target).off("submit.cashtippr")}))},e.prototype.addConfirmDeleteMessages=function(){var t=this;this.cashtippr.$(".ct-delete-shout-link").on("click",(function(e){var i=t.cashtippr.$("#ct-delete-shout-confirm").text();if(!0!==t.cashtippr.window.confirm(i))return e.preventDefault(),!1}))},e.prototype.scheduleCharsUpdate=function(){var t=this;0!==this.scheduleUpdateTimerID&&clearTimeout(this.scheduleUpdateTimerID),this.scheduleUpdateTimerID=setTimeout((function(){t.updateRemainingChars()}),50)},e}(i(0).AbstractModule);e.Shout=r},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.QrCode=void 0;var r=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.cashtippr.$(o.cashtippr.window.document).ready((function(t){o.cashtippr.$(".ct-qrcode-btn").click((function(t){o.showQrDialog(t.target)}))})),o}return n(e,t),e.prototype.showQrDialog=function(t){var e=this,i=this.cashtippr.$(t).parent().parent().parent().parent(),o=this.cashtippr.getPluginPaymentID(i),n=i.parent(),r=0;0!==n.find("input[name='amount']").length&&(r=parseInt(n.find("input[name='amount']").val()));var s={txid:o,am:r},a=this.webHelpers.translate(this.cashtippr.$("#ct-modal-qrcode-dialog-tpl").html(),{dialog_class:"dialog-"+o});this.cashtippr.$("body").append(a),this.webHelpers.getApi("/wp-json/cashtippr/v1/qrcode",s,(function(t){if(e.cashtippr.$(".ct-loading").remove(),!0===t.error)return e.cashtippr.window.console.error("Error starting QR code tip"),void e.cashtippr.window.console.error(t.errorMsg);e.cashtippr.$(".ct-qr-code").fadeIn("slow").attr("src",t.data[0])})),this.cashtippr.$(".ct-close-dialog").click((function(t){e.cashtippr.$(".dialog-"+o).remove()})),this.cashtippr.addCopyInputListeners()},e}(i(0).AbstractModule);e.QrCode=r},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.BadgerWallet=void 0;var r=i(1),s=function(t){function e(e,i,o){void 0===o&&(o=!1);var n=t.call(this,e,i)||this;return n.globalCallbacks=o,!0===n.globalCallbacks&&setTimeout((function(){n.cashtippr.window.onBadgerPayment=n.onBadgerPayment,n.cashtippr.window.onBadgerClientPayment=n.sendPaymentReceived}),0),n.cashtippr.$(n.cashtippr.window.document).ready((function(t){n.cashtippr.$(".ct-input-amount").keyup((function(t){n.updateButtonAmount(t.target)})),n.cashtippr.$(".ct-input-amount").change((function(t){n.updateButtonAmount(t.target)})),n.addEventListeners()})),n}return n(e,t),e.prototype.isInstalled=function(){return void 0!==this.cashtippr.window.web4bch},e.prototype.isLoggedIn=function(){var t=this.cashtippr.window;return"string"==typeof t.web4bch.bch.defaultAccount&&""!==t.web4bch.bch.defaultAccount},e.prototype.getDefaultAddress=function(){return this.cashtippr.window.web4bch.bch.defaultAccount},e.prototype.getDefaultSlpAddress=function(){return this.cashtippr.window.web4bch.bch.defaultSlpAccount},e.prototype.onBadgerPayment=function(t){var e=this;"string"==typeof t.buttonData&&0!==t.buttonData.length&&"{"!==t.buttonData[0]&&(t.buttonDataObj=JSON.parse(this.cashtippr.getWebHelpers().fromBase64(t.buttonData))||{}),void 0===t.domID&&(t.domID="ct-btn-wrap-"+t.buttonId);var i=this.cashtippr.getConfig();if(!0===i.show_search_engines||!0===i.ajaxConfirm)return t.buttonDataObj&&0===t.buttonDataObj.days?(this.cashtippr.$("#ct-hidden-"+t.buttonId).fadeIn("slow"),this.cashtippr.$("#ct-button-text-"+t.buttonId+", #ct-image-blurry-"+t.buttonId).fadeOut("slow"),!0===t.buttonDataObj.postHide&&this.cashtippr.$(".ct-more").fadeOut("slow")):(this.cashtippr.$(".ct-hidden-text").fadeIn("slow"),this.cashtippr.$(".ct-more, .ct-button-text, .ct-image-blurry").fadeOut("slow")),this.cashtippr.window.onBadgerClientPayment.call(this.cashtippr.badger,t,(function(i){t.buttonDataObj&&!0===t.buttonDataObj.shout&&e.cashtippr.shout.onPayment(t),t.buttonDataObj&&!0===t.buttonDataObj.woocommerce&&e.cashtippr.woocommerce.onPayment(t),e.cashtippr.adBlockDetect.onPayment(t)})),void("function"==typeof this.cashtippr.window.onCashtipprPayment&&this.cashtippr.window.onCashtipprPayment.call(this.cashtippr.window,{badger:t}));this.cashtippr.window.onBadgerClientPayment.call(this.cashtippr.badger,t,(function(i){t.buttonDataObj&&!0===t.buttonDataObj.shout?e.cashtippr.shout.onPayment(t):e.cashtippr.window.location.reload(!0)}))},e.prototype.addEventListeners=function(){var t=this;this.cashtippr.$(".ct-badger-button").click((function(i){!1===t.isInstalled()?t.cashtippr.window.open(e.INSTALL_URL,"",""):!1===t.isLoggedIn()?(i.preventDefault(),t.cashtippr.window.alert(t.cashtippr.getConfig().badgerLocked)):t.sendPayment(i.target)}))},e.prototype.sendPayment=function(t){var e=this,i=this.cashtippr.window,o=i.web4bch;o=new i.Web4Bch(o.currentProvider);var n=this.cashtippr.$(t),r={to:n.attr("data-to"),from:o.bch.defaultAccount,value:n.attr("data-satoshis")};o.bch.sendTransaction(r,(function(t,i){if(t)e.cashtippr.window.console.log("Error sending payment",t);else{var o=n.attr("data-success-callback");o&&"function"==typeof e.cashtippr.window[o]&&e.cashtippr.window[o](i)}}))},e.prototype.sendPaymentReceived=function(t,e){var i={txid:t.buttonId,am:t.amount,keep:!0===this.cashtippr.getConfig().keepTransaction};this.webHelpers.getApi("/wp-json/cashtippr/v1/mb-client",i,(function(t){e&&e(t)}))},e.prototype.updateButtonAmount=function(t){var e=this.cashtippr.$(t).parent().parent(),i=e.find(".badger-button");if(i){var o=parseFloat(this.cashtippr.$(t).val());if(0!==o&&o!==Number.NaN){var n=this.cashtippr.getConfig().display_currency,s=r.CashTippr.toSatoshis(o/this.cashtippr.getConfig().rate[n]);i.attr("data-satoshis",s),i.find(".ct-btn-display-amount").text(o)}}else this.cashtippr.window.console.error("Unable to find Badger button",e)},e.INSTALL_URL="https://badger.bitcoin.com/",e}(i(0).AbstractModule);e.BadgerWallet=s},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.SlpPress=void 0;var r=i(0),s=i(10),a=i(11),c=function(t){function e(e){var i=t.call(this,e)||this;return void 0===i.cashtippr.getConfig().distributeTokens||!0===i.cashtippr.$("body").hasClass("wp-admin")?i:(i.fingerPrint=new s.FingerPrint(i.cashtippr),i.cashtippr.$(i.cashtippr.window.document).ready((function(t){setTimeout(i.checkTokens.bind(i),1e3*i.cashtippr.getConfig().distributeTokens.timeSec)})),i)}return n(e,t),e.prototype.startSendingTokens=function(t,e){var i=this.cashtippr.getConfig().distributeTokens,o=this.cashtippr.getBadgerWallet();if(!0!==o.isInstalled())if(e){r=this.cashtippr.getWebHelpers().translate(i.tr.walletReceived,{amount:t,ticker:i.ticker,address:e});this.showTokenInfo(r+"<br>"+this.getTokenInfoLink(),!1,!0)}else{var n=this.cashtippr.getWebHelpers().translate(i.tr.enterWallet,{amount:t,ticker:i.ticker});this.askUserWallet(n+"<br>"+this.getTokenInfoLink())}else if(!1===o.isLoggedIn())this.showTokenInfo(this.cashtippr.getWebHelpers().translate(i.tr.unlockBadger,{amount:t,ticker:i.ticker}),!0,!1);else{var r=this.cashtippr.getWebHelpers().translate(i.tr.badgerReceived,{amount:t,ticker:i.ticker});this.showTokenInfo(r+"<br>"+this.getTokenInfoLink(),!1,!0)}},e.prototype.showTokenInfo=function(t,e,i){var o=this;void 0===e&&(e=!0),void 0===i&&(i=!1);var n=this.cashtippr.getConfig().distributeTokens.html.tokenMsg,r=this.getWpAdminbarHeight();n=this.webHelpers.translate(n,{message:t,style:0!==r?"top: "+r+"px;":""},!0),this.cashtippr.$("body").append(n),!1===i&&this.cashtippr.$(".ct-close-message").css("display","none"),this.cashtippr.$(".ct-close-message").off("click").on("click",(function(t){o.cashtippr.$("#ct-tokenMsg").remove()})),!1!==e?this.cashtippr.$(".ct-reload-page").off("click").on("click",(function(t){o.cashtippr.window.document.location.reload()})):this.cashtippr.$(".ct-reload-page").css("display","none")},e.prototype.askUserWallet=function(t){var e=this,i=this.cashtippr.getConfig().distributeTokens.html.askWallet,o=this.getWpAdminbarHeight();i=this.webHelpers.translate(i,{message:t,style:0!==o?"top: "+o+"px;":""},!0),this.cashtippr.$("body").append(i),this.cashtippr.$("#ct-input-slp-wallet-form").off("submit").on("submit",(function(t){t.preventDefault();var i={slpWallet:e.cashtippr.$("#ct-slp-wallet").val()};!1!==a.SlpAddress.isValidSlpAddress(i.slpWallet)?e.webHelpers.postApi("/wp-json/cashtippr-slp-press/v1/add-wallet",i,(function(t){!0!==t.error?(e.cashtippr.$("#ct-tokenMsg").remove(),e.checkTokens()):e.cashtippr.window.console.error("CashTippr: Error adding wallet:",t)})):e.cashtippr.window.alert(e.cashtippr.getConfig().distributeTokens.tr.invalidAddress)}))},e.prototype.getWpAdminbarHeight=function(){var t;return null!==(t=this.cashtippr.$("#wpadminbar").height())&&void 0!==t?t:0},e.prototype.getTokenInfoLink=function(){var t=this.cashtippr.getConfig().distributeTokens,e='<div class="ct-token-info"><a target="_blank" href="url">';return t.icon&&(e+='<img src="{iconSrc}" alt="{ticker}" width="32" height="32"> '),e+="{text}</a></div>",this.cashtippr.getWebHelpers().translate(e,{url:t.website,text:t.tr.moreInfo,iconSrc:t.icon,ticker:t.ticker})},e.prototype.checkTokens=function(){var t=this,e={userID:this.cashtippr.getConfig().distributeTokens.userID,fingerprint:this.fingerPrint.getCanvasFingerPrint()},i=this.cashtippr.getBadgerWallet();if(!0===i.isInstalled()){var o=i.getDefaultSlpAddress();o&&(e.badgerSlpAddress=o)}this.webHelpers.postApi("/wp-json/cashtippr-slp-press/v1/check-tokens",e,(function(e){if(!0!==e.error){var i=e.data[0].amount;i>0&&t.startSendingTokens(i,e.data[0].slpAddress)}else t.cashtippr.window.console.error("CashTippr: Error checking for tokens:",e)}))},e}(r.AbstractModule);e.SlpPress=c},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.FingerPrint=void 0;var r=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getCanvasFingerPrint=function(){this.cashtippr.$("body").append('<canvas id="ct-canvas" width="60" height="20"></canvas>');var t=this.cashtippr.window.document.getElementById("ct-canvas"),e=t.getContext("2d"),i="CashTippr.,com <canvas> 1.0";e.textBaseline="top",e.font="14px 'Arial'",e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText(i,2,15),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText(i,4,17);var o=t.toDataURL("image/png").replace("data:image/png;base64,","");if(this.cashtippr.$("#ct-canvas").remove(),"function"!=typeof this.cashtippr.window.atob)return"";var n=this.cashtippr.window.atob(o);return this.bin2hex(n.slice(-16,-12))},e.prototype.bin2hex=function(t){var e,i,o,n="";for(e=0,i=(t+="").length;e<i;e++)n+=(o=t.charCodeAt(e).toString(16)).length<2?"0"+o:o;return n},e}(i(0).AbstractModule);e.FingerPrint=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SlpAddress=void 0;var o=function(){function t(){}return t.isValidBchAddress=function(t){if(t){if(t=t.trim().toLowerCase(),!1===/^bitcoincash:/.test(t))return!1;if(54!==t.length)return!1;var e=t.split(":");return 2===e.length&&!0===/^[a-z0-9]+$/.test(e[1])}},t.isValidSlpAddress=function(t){if(t){if(t=t.trim().toLowerCase(),!1===/^simpleledger:/.test(t))return!1;if(55!==t.length)return!1;var e=t.split(":");return 2===e.length&&!0===/^[a-z0-9]+$/.test(e[1])}},t}();e.SlpAddress=o},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Woocommerce=void 0;var r=i(13),s=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.fullyPaid=!1,o.checkServerPaymentTimerID=0,o.cashtippr.$(o.cashtippr.window.document).ready((function(t){var e=o.cashtippr.getConfig();o.addButtonLinkClass(),e.checkPaymentIntervalSec>0&&setTimeout(o.checkPaymentStatus.bind(o,!0),1e3),0!==o.cashtippr.$("#ct-qrcode-form").length&&o.addPaymentFormEvents(o.cashtippr.$("#ct-qrcode-form").eq(0))})),o}return n(e,t),e.prototype.onPayment=function(t){this.sendPaymentForValidation(t)},e.prototype.sendPaymentForValidation=function(t){var e=this,i=this.cashtippr.$(".ct-btn-wrap-top"),o={txid:t.txid,dbtxid:this.cashtippr.getPluginPaymentID(i),am:t.amount};this.webHelpers.getApi("/wp-json/cashtippr-wc/v1/validate",o,(function(t){1===t.data.length&&e.cashtippr.window.document.location.assign(t.data[0].url)}))},e.prototype.addPaymentFormEvents=function(t){this.cashtippr.addCopyInputListeners()},e.prototype.checkPaymentStatus=function(t){var e=this;void 0===t&&(t=!0);var i=this.cashtippr.getConfig();if(!(void 0===i.nonce||i.orderID<=0)){var o={n:i.nonce,oid:i.orderID};clearTimeout(this.checkServerPaymentTimerID),this.webHelpers.getApi("/wp-json/cashtippr-wc/v1/order-status",o,(function(o){if(!0===t&&i.checkPaymentIntervalSec>0&&(clearTimeout(e.checkServerPaymentTimerID),e.checkServerPaymentTimerID=setTimeout(e.checkPaymentStatus.bind(e,!0),1e3*i.checkPaymentIntervalSec)),!0!==o.error){if(o.data&&o.data.length>=1){var n=Object.assign(new r.Order,o.data[0]);if("paid"===n.status)return void e.showPaymentReceived();if(n.bchAmountReceived>0)return void e.showPartialPayment(n)}}else e.cashtippr.window.console.error("Error checking BCH payment status: %s",o.errorMsg)}))}},e.prototype.showPartialPayment=function(t){var e=this.cashtippr.getConfig().paymentCommaDigits,i=t.calculateRemaningAmount().toFixed(e);this.cashtippr.$("#ct-pay-amount-txt").text()!==i&&(this.cashtippr.$("#ct-pay-amount-txt").text(i),this.cashtippr.$("#ct-payment-remaining").fadeIn("slow"),this.cashtippr.$("#ct-qr-code-image").attr("src",t.qrcode),this.cashtippr.$("#ct-address").val(t.uri),this.cashtippr.$("#ct-pay-app").attr("href",t.uri),this.cashtippr.$(".ct-badger-button").attr("data-satoshis",t.calculateRemaningAmount()))},e.prototype.showPaymentReceived=function(){!0!==this.fullyPaid&&(this.fullyPaid=!0,clearTimeout(this.checkServerPaymentTimerID),this.cashtippr.$("#ct-payment-status").text(this.cashtippr.getConfig().paidTxt),this.cashtippr.$("#ct-payment-pending, #ct-pay-instructions, .ct-payment-option").fadeOut("slow"))},e.prototype.addButtonLinkClass=function(){var t=this.cashtippr.$("#ct-pay-app");0!==t.length&&(!0===this.webHelpers.isExistingCssSelector("a.btn")?t.addClass("btn"):!0===this.webHelpers.isExistingCssSelector("a.button")?t.addClass("button"):t.addClass("ct-button-link"))},e}(i(0).AbstractModule);e.Woocommerce=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Order=void 0;var o=function(){function t(){}return t.prototype.calculateRemaningAmount=function(){return Math.max(0,this.bchAmount-this.bchAmountReceived)},t}();e.Order=o},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.AdBlockDetect=void 0;var r=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.cashtippr.$(o.cashtippr.window.document).ready((function(t){!0!==o.cashtippr.$("body").hasClass("wp-admin")&&(!1===o.cashtippr.getConfig().detect_adblock||o.cashtippr.getConfig().tipAmount>0||o.loadLib())})),o}return n(e,t),e.prototype.loadLib=function(){var t=this,e=this.cashtippr.window;if(!0===this.cashtippr.getConfig().adblockNoConflict||void 0===e.fuckAdBlock&&void 0===e.FuckAdBlock){e.fuckAdBlock=null;var i=this.cashtippr.window.document.createElement("script");i.onload=function(){e.fuckAdBlock=new e.FuckAdBlock({checkOnLoad:!0,resetOnEnd:!0,loopCheckTime:55,loopMaxNumber:6,baitClass:"pub_300x250 pub_300x250m pub_728x90 text-ad textAd banner_ad text_ad text_ads text-ads text-ad-links",baitStyle:"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;",debug:!1}),e.fuckAdBlock.onDetected(t.onAdBlockDetected.bind(t)),e.fuckAdBlock.onNotDetected(t.onAdBlockNotDetected.bind(t))},i.onerror=function(){t.onAdBlockDetected()},i.integrity="sha256-f5s2H2XgAi/4M/ipOOw8pxmim1o7cTOWL72QbKu0lSc=",i.crossOrigin="anonymous",i.src=this.cashtippr.getConfig().adBlockScript,this.cashtippr.window.document.head.appendChild(i)}else this.onAdBlockDetected()},e.prototype.onPayment=function(t){this.cashtippr.window.document.location.reload()},e.prototype.onAdBlockNotDetected=function(t){void 0===t&&(t=!1),!1===t&&this.loadAdFrame()},e.prototype.onAdBlockDetected=function(t){var e=this;void 0===t&&(t=!1);var i=this.cashtippr.window;"function"==typeof i&&i.ctipAdblockDetected();var o=!0===this.cashtippr.getConfig().adblockDisable;if(!0===o){var n=this.webHelpers.translate(this.cashtippr.$("#ct-modal-adblock-dialog-tpl").html(),{dialog_class:"dialog-adbl",title:"",text:""});this.cashtippr.$("body").append(n)}var r={msg:!0===o?"1":"0"};this.webHelpers.getApi("/wp-json/cashtippr/v1/get-post-notice",r,(function(t){if(e.cashtippr.$(".dialog-adbl").remove(),!0===o)if(!0!==t.error){var i=t.data[0].post.title,n=t.data[0].post.content,r=e.webHelpers.translate(e.cashtippr.$("#ct-modal-adblock-dialog-tpl").html(),{dialog_class:"dialog-adbl",title:i,text:n},!0);e.cashtippr.$("body").append(r),e.cashtippr.$("#ct-modal-adblock-dialog .ct-qrcode-wrap").css("display","none")}else e.cashtippr.$("#ct-adbl-title").text(t.errorMsg)}))},e.prototype.loadAdFrame=function(){var t=this;if(!0!==e.loadedAdFrame){e.loadedAdFrame=!0;var i=this.cashtippr.window.document.createElement("script"),o=this.cashtippr.window;i.onload=function(){setTimeout((function(){!0!==o.ctipAdblockOk?t.onAdBlockDetected(!0):t.onAdBlockNotDetected(!0)}),100)},i.onerror=function(){t.onAdBlockDetected(!0)},i.integrity="sha256-YrKAEKiVnq8uOpnEBYck9fbjgMBcJgjFcltgKGhtpkA=",i.crossOrigin="anonymous",i.src=this.cashtippr.getConfig().adFrameBaitUrl,this.cashtippr.window.document.head.appendChild(i)}},e.loadedAdFrame=!1,e}(i(0).AbstractModule);e.AdBlockDetect=r},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))((function(n,r){function s(t){try{c(o.next(t))}catch(t){r(t)}}function a(t){try{c(o.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}c((o=o.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var i,o,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.AdminControls=void 0;var a=i(0),c=i(16),p=i(17),l=function(t){function e(e){var i=t.call(this,e)||this;return i.slpSDK=null,i.distributingTokens=!1,i.queryPayoutsTimerID=0,i.walletImportOpen=!1,i}return n(e,t),e.prototype.init=function(){var t=this;-1!==this.cashtippr.$("body").attr("class").indexOf("cashtippr")&&(this.cashtippr.getTooltips().initToolTips(),this.cashtippr.$(this.cashtippr.window.document).ready((function(e){t.enableAdblockSettings(),t.enableSlpPressForPosts(t.cashtippr.window.document.getElementById("cashtippr_settings[enable_specific_pages]"),!0),t.enableSlpPressForPosts(t.cashtippr.window.document.getElementById("cashtippr_settings[enable_specific_posts]"),!1)})),this.cashtippr.$("#cashtippr_settings\\[detect_adblock\\]").on("change",(function(e){t.enableAdblockSettings()})),0!==this.cashtippr.$("#cashtippr_settings\\[create_new_wallet\\]").length&&(this.slpSDK=new c.SlpSDK(this.cashtippr)),this.toggleWalletCreateControls(),this.toggleSendingTokenState(),this.cashtippr.getAdminConfig().adminSlpWallet&&(this.displayWalletBalance(this.cashtippr.getAdminConfig().adminSlpWallet),this.displayBchWalletBalance()),this.cashtippr.$("#cashtippr_settings\\[enable_specific_pages\\]").on("change",(function(e){t.enableSlpPressForPosts(e.target,!0)})),this.cashtippr.$("#cashtippr_settings\\[enable_specific_posts\\]").on("change",(function(e){t.enableSlpPressForPosts(e.target,!1)})),this.cashtippr.$("#cashtippr_settings\\[create_new_wallet\\]").on("click",(function(e){!1!==t.isTokenConfigured()?t.createWallet():t.cashtippr.window.alert(t.cashtippr.getAdminConfig().distributeTokens.tr.configureToken)})),this.cashtippr.$("#cashtippr_settings\\[import_wallet\\]").on("click",(function(e){!1!==t.isTokenConfigured()?(t.cashtippr.$("#ct-wallet-import-controls").fadeToggle("slow"),t.walletImportOpen=!t.walletImportOpen,!0===t.walletImportOpen?t.cashtippr.$(".ct-import-wallet-input").prop("required",!0):t.cashtippr.$(".ct-import-wallet-input").removeProp("required")):t.cashtippr.window.alert(t.cashtippr.getAdminConfig().distributeTokens.tr.configureToken)})),this.cashtippr.$("#ct-btn-import-wallet").on("click",(function(e){t.importWallet(t.cashtippr.$("#ct-wallet-address-import").val(),t.cashtippr.$("#ct-wallet-passphrase-import").val())})),this.cashtippr.$("#cashtippr_settings\\[delete_wallet\\]").on("click",(function(e){return r(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return!0!==this.cashtippr.window.confirm(this.cashtippr.getAdminConfig().distributeTokens.tr.confirmDeleteWallet)?[2]:[4,this.deleteWallet()];case 1:return t.sent(),this.toggleWalletCreateControls(),[2]}}))}))})),this.cashtippr.$("#cashtippr_settings\\[start_distribution\\]").on("click",(function(e){t.distributingTokens=!0,t.toggleSendingTokenState(),t.scheduleQueryTokenDistribution(),t.cashtippr.$(t.cashtippr.window).bind("beforeunload",(function(e){return t.cashtippr.getAdminConfig().distributeTokens.tr.laavePage}))})),this.cashtippr.$("#cashtippr_settings\\[stop_distribution\\]").on("click",(function(e){t.distributingTokens=!1,t.toggleSendingTokenState(),clearTimeout(t.queryPayoutsTimerID),t.cashtippr.$(t.cashtippr.window).unbind("beforeunload")})))},e.prototype.enableAdblockSettings=function(){var t="#cashtippr_settings\\[adblockDisable\\], #cashtippr_settings\\[adblock_page\\], #cashtippr_settings\\[adblockNoConflict\\]";!1===(!0===this.cashtippr.$("#cashtippr_settings\\[detect_adblock\\]").is(":checked"))?this.cashtippr.$(t).prop("disabled",!0):this.cashtippr.$(t).removeProp("disabled")},e.prototype.enableSlpPressForPosts=function(t,e){var i=!0===e?"#cashtippr_settings\\[slp_press_pages\\]":"#cashtippr_settings\\[slp_press_posts\\]";!1===(!0===this.cashtippr.$(t).is(":checked"))?this.cashtippr.$(i).prop("disabled",!0):this.cashtippr.$(i).removeProp("disabled")},e.prototype.createWallet=function(){return r(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this.slpSDK.createWallet()];case 1:return t=e.sent(),[4,this.storeWallet(t.address,t.addressSlp,t.mnemonic)];case 2:return e.sent(),this.cashtippr.$("#ct-wallet-create-result").fadeIn("slow"),this.cashtippr.$("#ct-slp-address").val(t.addressSlp),this.cashtippr.$("#ct-wallet-address-bch").val(t.address),this.cashtippr.$("#ct-wallet-passphrase").val(t.mnemonic),this.toggleWalletCreateControls(),this.displayWalletBalance(t.address),this.displayBchWalletBalance(),[2]}}))}))},e.prototype.importWallet=function(t,e){return r(this,void 0,void 0,(function(){var i;return s(this,(function(o){switch(o.label){case 0:return[4,this.slpSDK.loginToWallet(t,e,!0)];case 1:return!1===o.sent()?(this.cashtippr.window.alert(this.cashtippr.getAdminConfig().distributeTokens.tr.invalidPassphrase),[2]):[4,this.slpSDK.getWalletAddresses(e,1)];case 2:return i=o.sent(),[4,this.storeWallet(i.address,t,e)];case 3:return o.sent(),this.cashtippr.getAdminConfig().distributeTokens.admin.addressBch=i.address,this.cashtippr.$("#ct-import-message").text(this.cashtippr.getAdminConfig().distributeTokens.tr.importOk),this.toggleWalletCreateControls(),this.displayWalletBalance(t),this.displayBchWalletBalance(),[2]}}))}))},e.prototype.displayWalletBalance=function(t){return r(this,void 0,void 0,(function(){var e;return s(this,(function(i){switch(i.label){case 0:return[4,this.slpSDK.getTokenBalance(t,this.cashtippr.getAdminConfig().distributeTokens.id)];case 1:return e=i.sent(),this.cashtippr.$("#ct-balance-amount").text(e),e<this.cashtippr.getAdminConfig().distributeTokens.amountLow&&this.cashtippr.$("#ct-slp-balance").addClass("ct-slp-low-balance"),[2]}}))}))},e.prototype.displayBchWalletBalance=function(){return r(this,void 0,void 0,(function(){var t;return s(this,(function(i){switch(i.label){case 0:return[4,this.slpSDK.getBalance(this.cashtippr.getAdminConfig().distributeTokens.admin.addressBch)];case 1:return t=i.sent(),this.cashtippr.$("#ct-bch-amount").text(t.toFixed(8)),t<e.BCH_BALANCE_LOW&&this.cashtippr.$("#ct-bch-balance").addClass("ct-slp-low-balance"),[2]}}))}))},e.prototype.storeWallet=function(t,e,i){var o=this;return new Promise((function(n,r){var s={address:e,addressBch:t,passphrase:i,n:o.cashtippr.getAdminConfig().distributeTokens.admin.token};o.webHelpers.postApi("/wp-json/cashtippr-slp-press/v1/add-create-wallet",s,(function(t){if(!0===t.error)return o.cashtippr.window.console.error("CashTippr: Error adding admin SLP wallet:",t),r({txt:"error adding admin wallet",res:t});o.cashtippr.getAdminConfig().adminSlpWallet=e,n()}))}))},e.prototype.deleteWallet=function(){var t=this;return new Promise((function(e,i){var o={n:t.cashtippr.getAdminConfig().distributeTokens.admin.token};t.webHelpers.postApi("/wp-json/cashtippr-slp-press/v1/delete-wallet",o,(function(o){if(!0===o.error)return t.cashtippr.window.console.error("CashTippr: Error deleting admin SLP wallet:",o),i({txt:"error deleting admin wallet",res:o});t.cashtippr.getAdminConfig().adminSlpWallet=void 0,e()}))}))},e.prototype.toggleWalletCreateControls=function(){var t=this.cashtippr.getAdminConfig();""==t.adminSlpWallet||void 0===t.adminSlpWallet?(this.cashtippr.$("#ct-address-balances").fadeOut("slow"),this.cashtippr.$("#cashtippr_settings\\[create_new_wallet\\], #cashtippr_settings\\[import_wallet\\]").parent().fadeIn("slow"),this.cashtippr.$("#cashtippr_settings\\[delete_wallet\\]").parent().fadeOut("slow")):(this.cashtippr.$("#ct-address-balances").fadeIn("slow"),this.cashtippr.$("#cashtippr_settings\\[create_new_wallet\\], #cashtippr_settings\\[import_wallet\\]").parent().fadeOut("slow"),this.cashtippr.$("#cashtippr_settings\\[delete_wallet\\]").parent().fadeIn("slow"))},e.prototype.toggleSendingTokenState=function(){!1===this.distributingTokens?(this.cashtippr.$("#ct-sending-activity").fadeOut("slow"),this.cashtippr.$("#cashtippr_settings\\[start_distribution\\]").prop("disabled",!1),this.cashtippr.$("#cashtippr_settings\\[stop_distribution\\]").prop("disabled",!0)):(this.cashtippr.$("#ct-sending-activity").fadeIn("slow"),this.cashtippr.$("#cashtippr_settings\\[start_distribution\\]").prop("disabled",!0),this.cashtippr.$("#cashtippr_settings\\[stop_distribution\\]").prop("disabled",!1))},e.prototype.isTokenConfigured=function(){var t=this.cashtippr.getConfig().distributeTokens;return void 0===t&&(t=this.cashtippr.getAdminConfig().distributeTokens),""!=t.id&&""!=t.ticker},e.prototype.sendTokens=function(t){return r(this,void 0,void 0,(function(){var e,i,o,n;return s(this,(function(r){switch(r.label){case 0:if(0===t.length)return[2];e=this.cashtippr.getAdminConfig().distributeTokens,i=e.ticker,o=!1,n=0,r.label=1;case 1:return n<t.length?(this.addLogLine("Sending "+t[n].amount+" "+i+" to "+t[n].address+" ...",!1),[4,this.slpSDK.sendToken(e.admin.mnemonic,t[n].address,e.id,t[n].amount)]):[3,6];case 2:return!0!==r.sent()?[3,4]:(this.addLogLine(" Done",!0),[4,this.notifyTokenSent(t[n])]);case 3:return r.sent(),[3,5];case 4:this.addLogLine(" Error",!0),o=!0,r.label=5;case 5:return n++,[3,1];case 6:if(!0===o)throw this.cashtippr.$("#ct-send-token-error").fadeIn("slow"),new Error("Error broadcasting TX to send tokens");return this.cashtippr.$("#ct-send-token-error").fadeOut("slow"),this.displayWalletBalance(this.cashtippr.getAdminConfig().adminSlpWallet),this.displayBchWalletBalance(),[2]}}))}))},e.prototype.notifyTokenSent=function(t){var e=this;return new Promise((function(i,o){var n={id:t.id,auth:e.cashtippr.getAdminConfig().slpDistributeNonce};e.webHelpers.getApi("/wp-json/cashtippr-slp-press/v1/notify-sent",n,(function(t){return r(e,void 0,void 0,(function(){return s(this,(function(e){return!0===t.error?[2,o({txt:"Error notifying sent tokens",res:t})]:(i(),[2])}))}))}))}))},e.prototype.queryTokenDistribution=function(){var t=this;return new Promise((function(e,i){clearTimeout(t.queryPayoutsTimerID);var o={auth:t.cashtippr.getAdminConfig().slpDistributeNonce};t.webHelpers.getApi("/wp-json/cashtippr-slp-press/v1/query-distribution",o,(function(o){return r(t,void 0,void 0,(function(){var t,n,r;return s(this,(function(s){switch(s.label){case 0:if(!0===o.error)return this.scheduleQueryTokenDistribution(),this.cashtippr.window.console.error("CashTippr: Error deleting admin SLP wallet:",o),[2,i({txt:"error deleting admin wallet",res:o})];for(t=[],n=0;n<o.data.length;n++)t.push(p.ReaderTokens.fromJson(o.data[n]));s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.sendTokens(t)];case 2:return s.sent(),this.scheduleQueryTokenDistribution(),[3,4];case 3:return r=s.sent(),this.scheduleQueryTokenDistribution(2e4),this.cashtippr.window.console.error("Error sending tokens",r),[3,4];case 4:return e(),[2]}}))}))})).fail((function(e){t.cashtippr.window.console.error("CashTippr: Error querying SLP tokens to distribute:",e),t.scheduleQueryTokenDistribution()}))}))},e.prototype.scheduleQueryTokenDistribution=function(t){var i=this;void 0===t&&(t=0),clearTimeout(this.queryPayoutsTimerID),!1!==this.distributingTokens&&(this.queryPayoutsTimerID=setTimeout((function(){i.queryTokenDistribution()}),e.QUERY_TOKEN_INTERVAL_MS+t))},e.prototype.addLogLine=function(t,e){void 0===e&&(e=!1),!0===e&&(t+="\r\n"),this.cashtippr.$("#ct-distribution-log").append(t),this.cashtippr.$("#ct-distribution-log").scrollTop(this.cashtippr.$("#ct-distribution-log")[0].scrollHeight)},e.QUERY_TOKEN_INTERVAL_MS=1500,e.BCH_BALANCE_LOW=5e-4,e}(a.AbstractModule);e.AdminControls=l},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))((function(n,r){function s(t){try{c(o.next(t))}catch(t){r(t)}}function a(t){try{c(o.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}c((o=o.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var i,o,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.SlpSDK=void 0;var a=function(t){function e(e){var i=t.call(this,e)||this;i.mnemonicLanguage="english",i.config={testnet:!1,restUrl:"https://rest.bitcoin.com/v2/"},i.className=i.constructor.name;var o=window;return i.slp=new o.ekliptor.blockchainAPI.SLP({restURL:i.config.restUrl}),i.slp.Blockchain.getBlockchainInfo().then((function(t){i.cashtippr.window.console.debug("Connected to %s blockchain %o",i.className,t)})).catch((function(t){i.cashtippr.window.console.error("Failed to connect to %s blockchain %o",i.className,t)})),i}return n(e,t),e.prototype.createWallet=function(){return r(this,void 0,void 0,(function(){var t,i,o,n,r,a,c;return s(this,(function(s){t=this.slp.Mnemonic.generate(128,this.slp.Mnemonic.wordLists()[this.mnemonicLanguage]),i=this.slp.Mnemonic.toSeed(t);try{o=this.slp.HDNode.fromSeed(i,this.config.testnet?"testnet":void 0)}catch(t){return[2,null]}for(n=[],r=[],a=0;a<e.CREATE_ADDRESS_COUNT;a++)c=o.derivePath("m/44'/145'/0'/0/"+a),n.push(this.slp.HDNode.toCashAddress(c)),r.push(this.slp.HDNode.toSLPAddress(c));return[2,{address:n[0],addressSlp:r[0],mnemonic:t,addressList:n,addressListSlp:r}]}))}))},e.prototype.loginToWallet=function(t,i,o){return r(this,void 0,void 0,(function(){var n,r,a,c;return s(this,(function(s){for(n=this.slp.Mnemonic.toSeed(i),r=this.slp.HDNode.fromSeed(n,this.config.testnet?"testnet":void 0),a=0;a<e.CHECK_ADDRESS_COUNT;a++)if(c=r.derivePath("m/44'/145'/0'/0/"+a),(!0===o?this.slp.HDNode.toSLPAddress(c):this.slp.HDNode.toCashAddress(c))===t)return[2,!0];return[2,!1]}))}))},e.prototype.getWalletAddresses=function(t,i){return void 0===i&&(i=-1),r(this,void 0,void 0,(function(){var o,n,r,a,c,p;return s(this,(function(s){o=this.slp.Mnemonic.toSeed(t);try{n=this.slp.HDNode.fromSeed(o,this.config.testnet?"testnet":void 0)}catch(t){return[2,null]}for(r=[],a=[],-1===i&&(i=e.CREATE_ADDRESS_COUNT),c=0;c<i;c++)p=n.derivePath("m/44'/145'/0'/0/"+c),r.push(this.slp.HDNode.toCashAddress(p)),a.push(this.slp.HDNode.toSLPAddress(p));return[2,{address:r[0],addressSlp:a[0],mnemonic:t,addressList:r,addressListSlp:a}]}))}))},e.prototype.getBalanceByKey=function(t){return r(this,void 0,void 0,(function(){var e,i,o,n;return s(this,(function(r){return e=this.slp.Mnemonic.toSeed(t),i=this.slp.HDNode.fromSeed(e,this.config.testnet?"testnet":void 0),o=i.derivePath("m/44'/145'/0'/0/0"),n=this.slp.HDNode.toCashAddress(o),[2,this.getBalance(n)]}))}))},e.prototype.getBalance=function(t){return r(this,void 0,void 0,(function(){var e,i;return s(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.slp.Address.details(t)];case 1:return!(e=o.sent())||e.balance<0?[2,0]:[2,e.balance];case 2:return i=o.sent(),this.cashtippr.window.console.error("Error in getBalance: ",i),[2,0];case 3:return[2]}}))}))},e.prototype.getTokenBalance=function(t,e){return r(this,void 0,void 0,(function(){var i,o,n;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.slp.Utils.balancesForAddress(t)];case 1:if(i=r.sent(),!1===Array.isArray(i))return[2,0];for(o=0;o<i.length;o++)if(i[o].tokenId===e)return[2,i[o].balance];return[2,0];case 2:return n=r.sent(),this.cashtippr.window.console.error("Error getting token balances:",n),[2,0];case 3:return[2]}}))}))},e.prototype.sendToken=function(t,e,i,o){return r(this,void 0,void 0,(function(){var n,r,a,c,p,l,d,h,u,f;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),n=this.slp.Mnemonic.toSeed(t),r=this.slp.HDNode.fromSeed(n,this.config.testnet?"testnet":void 0),a=this.slp.HDNode.derivePath(r,"m/44'/145'/0'"),c=this.slp.HDNode.derivePath(a,"0/0"),p=this.slp.HDNode.toCashAddress(c),l=this.slp.HDNode.toSLPAddress(c),d=l,h=this.slp.HDNode.toWIF(c),u={fundingAddress:d,fundingWif:h,tokenReceiverAddress:e,bchChangeReceiverAddress:p,tokenId:i,amount:o},[4,this.slp.TokenType1.send(u)];case 1:return[2,""!=s.sent()];case 2:return f=s.sent(),this.cashtippr.window.console.error("Error in sendToken: ",f),[2,!1];case 3:return[2]}}))}))},e.CREATE_ADDRESS_COUNT=10,e.CHECK_ADDRESS_COUNT=100,e}(i(0).AbstractModule);e.SlpSDK=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReaderTokens=void 0;var o=function(){function t(t){this.id="number"==typeof t?t:parseInt(t)}return t.fromJson=function(e){var i=new t(e.id);return i.amount=parseFloat(e.amount),i.address=e.address,i},t}();e.ReaderTokens=o}]);
//# sourceMappingURL=bundle.js.map